{% extends "base.html" %}

{% block title %}Energy Consumption Dashboard{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
<style>
  /* Loading Spinner */
  .spinner {
    display: none;
    width: 50px;
    height: 50px;
    border: 5px solid rgba(0, 0, 0, 0.1);
    border-top: 5px solid #3498db;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 20px auto;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  .tab-button {
    padding: 10px 20px;
    background-color: #007bff;
    color: white;
    border: none;
    cursor: pointer;
    margin-right: 10px;
    border-radius: 5px;
  }

  .tab-button.active {
    background-color: #0056b3;
  }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-container">
  <div class="dashboard-header">
    <h1>Energy Consumption Dashboard</h1>
    <p>Live prediction of monthly energy usage using AI models</p>

    <!-- Tab Switch Buttons -->
    <div style="text-align: center; margin-bottom: 20px;">
      <button id="predictionTab" class="tab-button active">Prediction</button>
      <button id="analysisTab" class="tab-button">Previous Analysis</button>
    </div>

    <!-- Year selection -->
    <div class="year-selector" style="margin-top: 1rem;">
      <label for="yearSelect">Select Prediction Year:</label>
      <select id="yearSelect">
        <option value="2025">2025</option>
        <option value="2026">2026</option>
      </select>
    </div>
  </div>

  <!-- Loading Spinner -->
  <div class="spinner" id="spinner"></div>

  <!-- Graphs Container -->
  <div class="graphs-container">
    
    <!-- Prediction Section -->
    <div id="predictionSection">
      <div class="graph-section">
        <h2>Predicted Monthly Energy Consumption</h2>
        <div class="chart-grid">
          <div class="chart-card">
            <h3>Monthly Bar Chart</h3>
            <div class="chart-container">
              <canvas id="monthlyBarChart"></canvas>
            </div>
          </div>

          <div class="chart-card">
            <h3>Monthly Line Chart</h3>
            <div class="chart-container">
              <canvas id="monthlyLineChart"></canvas>
            </div>
          </div>

          <div class="chart-card">
            <h3>Monthly Pie Chart</h3>
            <div class="chart-container">
              <canvas id="monthlyPieChart"></canvas>
            </div>
          </div>
        </div>
      </div>

      <div class="graph-section">
        <h2>Predicted Total Yearly Energy Consumption</h2>
        <div class="chart-grid">
          <div class="chart-card">
            <h3>Yearly Bar Chart</h3>
            <div class="chart-container">
              <canvas id="yearlyBarChart"></canvas>
            </div>
          </div>

        </div>
      </div>
    </div>

    <!-- Previous Data Analysis Section -->
    <div id="analysisSection" style="display: none;">
      <div class="graph-section">
        <h2>Previous Data Analysis</h2>
        <div class="chart-grid">
          <div class="chart-card">
            <h3>Yearly Usage</h3>
            <div class="chart-container">
              <canvas id="yearlyUsageChart"></canvas>
            </div>
          </div>

          <div class="chart-card">
            <h3>Monthly Usage</h3>
            <div class="chart-container">
              <canvas id="monthlyUsageChart"></canvas>
            </div>
          </div>

          <div class="chart-card">
            <h3>Urban vs Rural Usage</h3>
            <div class="chart-container">
              <canvas id="urbanRuralChart"></canvas>
            </div>
          </div>

          <div class="chart-card">
            <h3>Urban Sector Usage</h3>
            <div class="chart-container">
              <canvas id="urbanSectorChart"></canvas>
            </div>
          </div>

          <div class="chart-card">
            <h3>Rural Sector Usage</h3>
            <div class="chart-container">
              <canvas id="ruralSectorChart"></canvas>
            </div>
          </div>

          <div class="chart-card">
            <h3>Seasonal Usage</h3>
            <div class="chart-container">
              <canvas id="seasonUsageChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}
